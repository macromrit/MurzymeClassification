from sentence_transformers import SentenceTransformer
import pickle as pkl

# HF Model id -> sentence-transformers/all-MiniLM-L6-v2
embeddings_model = SentenceTransformer('sentence-transformers/all-MiniLM-L6-v2')

def inpEncoder(inp: str):
    return [[float(ftr) for ftr in embeddings_model.encode(inp)]]

with open('pdb_svm_classifier.pkl', 'rb') as jammer:
    classification_model = pkl.load(jammer)

def classificationWrapper(inp: str):
    return classification_model.predict(inpEncoder(inp))[0]

if __name__ == '__main__':
    # Test-Case - Murzymes
    # print(classification_model.predict([[-0.08705662935972214, -0.01232546754181385, -0.07890103757381439, 0.05585174635052681, 0.008703070692718029, -0.07411886751651764, -0.013159377500414848, 0.050965920090675354, 0.011054017581045628, -0.026073772460222244, -0.012100288644433022, 0.028919920325279236, -0.07123655825853348, 0.05332658439874649, -0.05569600313901901, 0.06451483815908432, -0.06760916113853455, 0.05173337087035179, -0.06195884197950363, 0.0076889051124453545, -0.0007910951972007751, 0.032308876514434814, 0.0627632737159729, -0.014997060410678387, 0.012166538275778294, 0.0057515031658113, -0.04562152177095413, 0.06253894418478012, -0.0009758775704540312, -0.05886845290660858, 0.06471733748912811, -0.02940777875483036, 0.04975076764822006, -0.033777523785829544, 0.09397416561841965, 0.052966710180044174, 0.014953256584703922, -0.0956188514828682, 0.06488398462533951, -0.02589457668364048, 0.06347236782312393, 0.08029499650001526, 0.04260694235563278, 0.06990832835435867, -0.0339614637196064, 0.023681554943323135, 0.008478157222270966, -0.009730128571391106, 0.029669957235455513, 0.041449494659900665, -0.0236093420535326, -0.04751630872488022, -0.1665145754814148, 0.1033361479640007, 0.03197020664811134, 0.01731470786035061, -0.06561269611120224, -0.007450593635439873, -0.006852405145764351, -0.01055236253887415, -0.013862074352800846, 0.050329286605119705, 0.06685498356819153, 0.010940415784716606, -0.10330604761838913, -0.028862493112683296, 0.03362375497817993, -0.09679808467626572, -0.07044881582260132, -0.011587439104914665, -0.006677098572254181, 0.01589406095445156, 0.07231371849775314, 0.06642944365739822, -0.08190013468265533, 0.029190484434366226, -0.018196335062384605, -0.06004011258482933, 0.06490436941385269, 0.060510944575071335, 0.026970433071255684, 0.004588534589856863, 0.046956200152635574, 0.11979133635759354, -0.07015883177518845, -0.05364586412906647, 0.02899821475148201, -0.04748589172959328, -0.03273123875260353, -0.044192563742399216, 0.019291412085294724, -0.026777243241667747, 0.029604356735944748, -0.0037779719568789005, -0.048963651061058044, -0.07160007208585739, 0.1483529508113861, 0.07566618174314499, -0.007119175046682358, 0.02535959891974926, 0.023636624217033386, 0.0485113188624382, 0.04338769242167473, -0.0998946949839592, -0.0013681754935532808, -0.0029609459452331066, -0.0025013298727571964, 0.11614576727151871, 0.03046252951025963, 0.0217494647949934, 0.009170806035399437, -0.0084000863134861, 0.019940247759222984, -0.044196926057338715, 0.031412214040756226, 0.01613049954175949, -0.07529860734939575, 0.018576953560113907, -0.025236191228032112, 0.004682973027229309, -0.005503604654222727, -0.032232534140348434, 0.06053076311945915, 0.010829616338014603, -0.05371958017349243, -0.032360583543777466, -0.040529169142246246, 1.9610586747065983e-33, 0.09242872893810272, -0.060253873467445374, 0.05479104071855545, 0.004895396996289492, -0.07430854439735413, -0.018742812797427177, -0.014385652728378773, -0.05887708440423012, -0.006089953240007162, 0.08635038137435913, -0.1302669644355774, -0.0052331360056996346, 0.01896393671631813, 0.024966852739453316, -0.06306395679712296, -0.08569075167179108, -0.05537421256303787, 0.026713339611887932, -0.008653150871396065, 0.07525913417339325, 0.011322466656565666, 0.04453040659427643, -0.014553055167198181, -0.01548779383301735, 0.01635349728167057, 0.05855489894747734, -0.02283196896314621, -0.042294617742300034, -0.025661537423729897, 0.00857836939394474, 0.03693869337439537, -0.012974096462130547, -0.19516287744045258, -0.02821704000234604, 0.002684561302885413, -0.010879251174628735, 0.023144913837313652, -0.013076409697532654, -0.02312590554356575, -0.041810646653175354, 0.027112839743494987, 0.05644744262099266, 0.009423485957086086, -0.09110896289348602, 0.11157431453466415, 0.03562871739268303, -0.014572015032172203, 0.062412429600954056, 0.025936543941497803, 0.05282454937696457, -0.023143518716096878, -0.0777369886636734, 0.02885592170059681, 0.06574863195419312, -0.037171147763729095, -0.02078411541879177, 0.012951902113854885, 0.02208230085670948, 0.01959887519478798, 0.0023188346531242132, 0.013443177565932274, 0.03934205695986748, 0.00923786498606205, 0.017955251038074493, -0.02615894190967083, 0.036498911678791046, -0.05217479541897774, -0.07530858367681503, -0.04155382141470909, 0.002180639188736677, 0.024120334535837173, -0.0004971208400093019, 0.025997573509812355, -0.035665567964315414, 0.00481803435832262, -0.06405360996723175, 0.036573443561792374, 0.056859340518713, 0.03163972124457359, -0.006587851792573929, 0.03448369354009628, -0.011787408031523228, 0.005588813219219446, -0.07015123963356018, -0.0824921578168869, -0.021235357969999313, 0.016056673601269722, 0.058793000876903534, -0.07438287883996964, 0.02732769399881363, 0.05326710268855095, 0.008511981926858425, -0.06419920921325684, -0.10061097890138626, -0.05349487066268921, -2.981834826415641e-33, 0.09820234775543213, -0.09793326258659363, 0.0005647805519402027, -0.08680568635463715, -0.03232518956065178, 0.039617739617824554, -0.058615799993276596, 0.06228272244334221, -0.0019430683460086584, -0.08769530057907104, 0.04878699406981468, 0.023907875642180443, -0.010334381833672523, -0.045005809515714645, 0.05184115096926689, -0.025374211370944977, -0.057691559195518494, -0.004644052591174841, 0.008061708882451057, 0.02053617686033249, -0.041520994156599045, -0.03710619732737541, 0.007323369383811951, -0.016489962115883827, 0.06688927859067917, 0.024680983275175095, -0.016653472557663918, -0.04860525578260422, 0.04907456412911415, 0.05779578536748886, -0.09849981218576431, -0.007770154159516096, -0.06974606215953827, 0.001560850185342133, -0.013213307596743107, -0.0517081581056118, -0.043091751635074615, -0.10141010582447052, -0.013305837288498878, -0.015110808424651623, 0.018718179315328598, 0.04342329502105713, -0.008925982750952244, 0.08835580199956894, 0.0838894173502922, 0.05339754372835159, -0.05966304615139961, -0.04826731234788895, 0.05908866599202156, -0.011962560005486012, -0.02912062406539917, -0.06486310809850693, -0.05563975125551224, -0.0533432699739933, 0.018160944804549217, 0.09191005676984787, -0.030420085415244102, 0.018991660326719284, -0.0021405278239399195, -0.040138378739356995, 0.06859743595123291, -0.05696724355220795, 0.07240507751703262, 0.01146000251173973, -0.09199955314397812, 0.11702017486095428, 0.07192250341176987, -0.03404120355844498, 0.0013067559339106083, -0.032369885593652725, 0.04991992935538292, 0.0022026272490620613, 0.031644098460674286, 0.03672518581151962, 0.04963019862771034, -0.02131778374314308, -0.03520197048783302, 0.01759352721273899, -0.03485732153058052, 0.03088449127972126, 0.018011456355452538, 0.04669863358139992, -0.0007632340420968831, 0.03327934071421623, 0.08454579859972, 0.014255587011575699, 0.022378064692020416, 0.05640246719121933, -0.07593394070863724, 0.008917191997170448, -0.031155647709965706, 0.03016703762114048, -0.04253322258591652, 0.08252280950546265, 0.039341822266578674, -2.432368262361706e-08, -0.03837960958480835, -0.015312052331864834, 0.0389709398150444, -0.007522688712924719, -0.009275159798562527, 0.12085563689470291, 0.025295859202742577, 0.016539515927433968, 0.04442114382982254, 0.023446587845683098, 0.11784729361534119, 0.13381168246269226, -0.04230991005897522, 0.015230330638587475, -0.024415364488959312, -0.02796991541981697, -0.06250890344381332, -0.07648054510354996, 0.011444593779742718, 0.05676167458295822, 0.0039998674765229225, 0.0005650891689583659, 0.049505218863487244, 0.014333343133330345, 0.01805981807410717, -0.025921395048499107, -0.03459421172738075, 0.03752508386969566, -0.00839502178132534, -0.02121199294924736, 0.046895548701286316, 0.07682439684867859, 0.023317350074648857, -0.045942045748233795, -0.019132647663354874, -0.03270910307765007, 0.015248361974954605, 0.029111262410879135, -0.036454495042562485, 0.003562189405784011, -0.10875962674617767, -0.04457211121916771, -0.0501665323972702, -0.009367997758090496, 0.04681418836116791, 0.009275766089558601, 0.026903633028268814, 0.03967287391424179, -0.08587197214365005, -0.02866043522953987, 0.02810319885611534, -0.013381498865783215, -0.08302931487560272, -0.02684503234922886, -0.07497543096542358, 0.08517831563949585, -0.05296757072210312, 0.03849579766392708, -0.07710333913564682, 0.0009006743202917278, -0.06937490403652191, -0.043240197002887726, 0.037124913185834885, 0.004821902606636286]]))
    
    # Test-Case - Embedding Model
    # print(inpEncoder("Hello World, Lets see"))
    # pass
    pass